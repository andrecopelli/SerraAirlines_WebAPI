CREATE DATABASE SERRA_LINHAS_AEREAS_BD;

CREATE TABLE CLIENTES (
    CPF VARCHAR(11) NOT NULL,
    NOME VARCHAR(30) NOT NULL,
    SOBRENOME VARCHAR(30) NOT NULL,
    CEP VARCHAR(8) NOT NULL,
    RUA VARCHAR(200) NOT NULL,
    NUMERO INT NULL,
    BAIRRO VARCHAR(200) NOT NULL,
    CIDADE VARCHAR(100) NOT NULL,
    ESTADO VARCHAR(50) NOT NULL,
    COMPLEMENTO VARCHAR(400) NULL,
    CONSTRAINT PK_CLIENTE PRIMARY KEY(CPF)
);

CREATE TABLE PASSAGENS (
    ID INT IDENTITY(1,1) NOT NULL,
    ORIGEM VARCHAR(50) NOT NULL,
    DESTINO VARCHAR(50) NOT NULL,
    VALOR DECIMAL(10,2) NOT NULL,
    DATA_ORIGEM DATETIME NOT NULL,
    DATA_DESTINO DATETIME NOT NULL,
    CONSTRAINT PK_PASSAGEM PRIMARY KEY(ID) 
);

CREATE TABLE VIAGENS (
    ID INT IDENTITY(1,1) NOT NULL,
    CODIGO_RESERVA VARCHAR(6) NOT NULL,
    DATA_COMPRA DATETIME NOT NULL,
    EH_SOH_IDA BIT NOT NULL,
    CLIENTE_ID VARCHAR(11) NOT NULL,
    PASSAGEM_IDA_ID INT NOT NULL,
    PASSAGEM_VOLTA_ID INT NULL,
    CONSTRAINT PK_VIAGEM PRIMARY KEY(ID),
    CONSTRAINT FK_CLIENTE_VIAGEM FOREIGN KEY(CLIENTE_ID) REFERENCES CLIENTES(CPF),
    CONSTRAINT FK_IDA_VIAGEM FOREIGN KEY(PASSAGEM_IDA_ID) REFERENCES PASSAGENS(ID),
    CONSTRAINT FK_VOLTA_VIAGEM FOREIGN KEY(PASSAGEM_VOLTA_ID) REFERENCES PASSAGENS(ID)
);

INSERT INTO CLIENTES (CPF, NOME, SOBRENOME, CEP, RUA, NUMERO, BAIRRO, CIDADE, ESTADO, COMPLEMENTO) VALUES 
	('11111111111', 'ANDRÉ', 'COPELLI', '89540000', 'JOAO GOETTEN SOBRINHO', 399, 'CENTRO', 'SANTA CECÍLIA', 'SANTA CATARINA',''),
	('22222222222', 'CECÍLIA', 'GOMES', '89540000', 'SARGENTO JUVENIL', 711, 'CENTRO', 'SANTA CECÍLIA', 'SANTA CATARINA', 'PRÓXIMO A FARMÁCIA'),
	('33333333333', 'MARILAINE', 'DE FÁTIMA', '89540000', 'XV DE NOVEMBRO', 1596, 'CENTRO', 'SANTA CECÍLIA', 'SANTA CATARINA', ''),
	('44444444444', 'PEDRO', 'SOUZA', '89540000', 'JOÃO MARIA PALHANO', 689, 'ADOLFO CORREIA DA SILVA', 'SANTA CECÍLIA', 'SANTA CATARINA', 'DO LADO DA IGREJA'),
	('55555555555', 'FÁTIMA', 'CARDOSO', '88020710', 'CORREIA PINTO', 118, 'CENTRO', 'LAGES', 'SANTA CATARINA', 'PRÓXIMO A PRAÇA');

INSERT INTO PASSAGENS (ORIGEM, DESTINO, VALOR, DATA_ORIGEM, DATA_DESTINO) VALUES 
	('LAGES', 'CAÇADOR', 235.28, '27-09-2022 10:30:00', '27-09-2022 11:10:00'),
	('CAÇADOR', 'LAGES', 248.56, '28-09-2022 22:20:00', '28-09-2022 23:00:00'),
	('MAFRA', 'CURITIBANOS', 356.23, '16-09-2022 14:30:00', '16-09-2022 15:50:00'),
	('LAGES', 'CURITIBANOS', 98.75, '21-09-2022 21:45:00', '21-09-2022 22:40:00'),
	('VIDEIRA', 'SÃO JOAQUIM', 435.56, '02-10-2022 11:30:00', '02-10-2022 12:55:00'),
	('SÃO JOAQUIM', 'VIDEIRA', 448.36, '06-10-2022 10:30:00', '06-10-2022 11:45:00'),
	('LAGES', 'MAFRA', 325.52, '30-11-2022 04:45:00', '30-11-2022 06:10:00');

INSERT INTO VIAGENS (CODIGO_RESERVA, DATA_COMPRA, VALOR_TOTAL, EH_SOH_IDA, CLIENTE_ID, PASSAGEM_IDA_ID, PASSAGEM_VOLTA_ID) VALUES
	('AAAAAA', '02-09-2022', 483.84, 0, '11111111111', 1, 2),
	('BBBBBB', '28-08-2022', 356.23, 1, '22222222222', 3, NULL),
	('CCCCCC', '12-09-2022', 98.75, 1, '33333333333', 4, NULL),
	('DDDDDD', '15-09-2022', 883.92, 0, '44444444444', 5, 6),
	('EEEEEE', '02-09-2022', 325.52, 1, '55555555555', 7, NULL);

SELECT * FROM CLIENTES;
SELECT * FROM PASSAGENS;
SELECT * FROM VIAGENS;